{{ partial "header.html" . }}

<div class="content">
    <div class="container">

            <article class="post">
                <header class="post-header">
                    {{ partial "breadcrumbs.html" . }}
                    <h1>{{ .Title }}</h1>
                </header>
                
                {{ .Content }}

                <br>
                <br>
                <ul class="nestedmenu">
                    {{ $regularpages := .RegularPages.ByTitle }}
                    
                    {{ $.Scratch.Set "haschildren" "" }}
                    {{ range where $regularpages "Params.parent_branch" "!=" nil }}
                        {{ if in ($.Scratch.Get "haschildren") .Params.parent_branch }}{{ else }}
                            {{ $.Scratch.Add "haschildren" (print " " .Params.parent_branch) }}
                        {{ end }}
                    {{ end }}
                    {{ $haschildren := split ($.Scratch.Get "haschildren") " " }}

                    {{ range where $regularpages "Params.parent_branch" nil }}
                        <li {{ if in $haschildren .File.BaseFileName }}class="haschildren"{{ end }}><a href="{{ .RelPermalink }}">{{ .Title }}</a>
                            <ul>
                            {{ range where $regularpages "Params.parent_branch" .File.BaseFileName }}
                                <li {{ if in $haschildren .File.BaseFileName }}class="haschildren"{{ end }}><a href="{{ .RelPermalink }}">{{ .Title }}</a>
                                    <ul>
                                        {{ range where $regularpages "Params.parent_branch" .File.BaseFileName }}
                                            <li {{ if in $haschildren .File.BaseFileName }}class="haschildren"{{ end }}><a href="{{ .RelPermalink }}">{{ .Title }}</a></li>
                                        {{ end }}
                                    </ul>
                                </li>
                            {{ end }}
                            </ul>
                        </li>
                    {{ end }}
                </ul>

            </article>

    </div>
</div>

{{ partial "footer.html" . }}
